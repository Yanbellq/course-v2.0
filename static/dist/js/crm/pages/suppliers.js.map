{"version":3,"names":[],"mappings":"","sources":["pages/suppliers.js"],"sourcesContent":["// static/src/js/pages/suppliers.js\n\nimport Button from '../components/button.js';\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const supplierTable = document.querySelector('#supplier-list-table');\n    if (supplierTable) {\n        console.log('Initializing supplier list page...');\n        loadSuppliers().then(r => console.log(r));\n    }\n});\n\nconst pageHeaderActions = document.querySelector('#page-header-actions');\nif (pageHeaderActions) {\n    pageHeaderActions.insertAdjacentHTML('beforeend',\n        Button('Додати постачальника', \"add\", 'shadow-glow', 'plus', '')\n    );\n    // if (window.lucide?.createIcons) window.lucide.createIcons();\n}\n\nasync function loadSuppliers() {\n    const tableBody = document.querySelector('#supplier-list-body');\n    if (!tableBody) return;\n\n    tableBody.innerHTML = `\n        <tr>\n            <td colspan=\"5\" class=\"text-center\">\n                <div class=\"loading-spinner\" style=\"display: inline-block; vertical-align: middle;\">\n                    <div class=\"spinner\" style=\"width: 24px; height: 24px; border-width: 3px;\"></div>\n                </div>\n                <span style=\"vertical-align: middle; margin-left: 10px;\">Завантаження постачальників...</span>\n            </td>\n        </tr>\n    `;\n\n    try {\n        const response = await PCManagement.apiRequest('/suppliers/');\n        renderSuppliers(response.suppliers, tableBody);\n    } catch (error) {\n        console.error('Failed to load suppliers:', error);\n        tableBody.innerHTML = `\n            <tr>\n                <td colspan=\"5\" class=\"text-center text-error\">\n                    Не вдалося завантажити список постачальників.\n                </td>\n            </tr>\n        `;\n    }\n}\n\nfunction renderSuppliers(suppliers, tableBody) {\n    if (!suppliers || suppliers.length === 0) {\n        tableBody.innerHTML = `\n            <tr>\n                <td colspan=\"5\" class=\"text-center\">Постачальників не знайдено. <a href=\"/suppliers/add/\" class=\"text-primary underline\">Додайте першого</a>.</td>\n            </tr>\n        `;\n        return;\n    }\n\n    tableBody.innerHTML = suppliers.map(supplier => `\n        <tr data-supplier-id=\"${supplier.id}\">\n            <td><a href=\"/suppliers/${supplier.id}/\" class=\"font-semibold underline\">${supplier.name}</a></td>\n            <td>${supplier.contact_person || '—'}</td>\n            <td>${supplier.email}</td>\n            <td>${supplier.phone}</td>\n            <td class=\"dropdown-data\">\n                <button type=\"button\" class=\"dropdown-toggle\">...</button>\n                <ul class=\"dropdown-menu\">\n                    <li>\n                        <a href=\"/suppliers/${supplier.id}/edit/\" class=\"btn btn--sm btn--secondary\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" data-lucide=\"square-pen\" class=\"lucide lucide-square-pen h-4 w-4\">\n                                <path d=\"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\n                                <path d=\"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z\"></path>\n                            </svg>\n                            Редагувати\n                        </a>\n                    </li>\n                    <li>\n                        <button class=\"btn btn--sm btn--error w-full\" data-action=\"delete\" data-url=\"/suppliers/${supplier.id}/\" data-confirm=\"Ви впевнені, що хочете видалити постачальника ${supplier.name}?\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" data-lucide=\"trash-2\" class=\"lucide lucide-trash-2 h-4 w-4\">\n                                <path d=\"M10 11v6\"></path><path d=\"M14 11v6\"></path>\n                                <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6\"></path>\n                                <path d=\"M3 6h18\"></path><path d=\"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"></path>\n                            </svg>\n                            Видалити\n                        </button>\n                    </li>\n                </ul>\n            </td>\n        </tr>\n    `).join('');\n\n\n    function initDropdowns() {\n        document.querySelectorAll('.dropdown-data').forEach(dropdown => {\n            const dropdownToggle = dropdown.querySelector('.dropdown-toggle');\n            const dropdownMenu = dropdown.querySelector('.dropdown-menu');\n\n            dropdownToggle.addEventListener('click', (e) => {\n                // Close all dropdowns first\n                document.querySelectorAll('.dropdown-menu.active').forEach(menu => {\n                    if (menu !== dropdownMenu) {\n                        menu.classList.remove('active');\n                    }\n                });\n                // Toggle only the clicked dropdown\n                dropdownMenu.classList.toggle('active');\n            });\n        });\n\n        // Optional: close dropdowns when clicking outside\n        document.addEventListener('click', (e) => {\n            if (!e.target.closest('.dropdown-data')) {\n                document.querySelectorAll('.dropdown-menu.active').forEach(menu => {\n                    menu.classList.remove('active');\n                });\n            }\n        });\n    }\n\n    initDropdowns();\n}"],"file":"pages/suppliers.js"}