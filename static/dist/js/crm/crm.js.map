{"version":3,"names":[],"mappings":"","sources":["crm.js"],"sourcesContent":["// static/src/js/crm/crm.js\r\n\r\nimport showNotification from \"../user/toast.js\";\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n    const deleteForms = document.querySelectorAll(\"form.delete-item\");\r\n\r\n    deleteForms.forEach((form) => {\r\n        form.addEventListener(\"submit\", async (e) => {\r\n            e.preventDefault();\r\n\r\n            const url = form.action;  // Django URL /crm/supplier/delete/ID/\r\n\r\n            const csrf = form.querySelector(\"input[name='csrfmiddlewaretoken']\")?.value;\r\n\r\n            try {\r\n                const response = await fetch(url, {\r\n                    method: \"POST\",\r\n                    credentials: \"include\",\r\n                    headers: {\r\n                        \"X-CSRFToken\": csrf,\r\n                        \"Accept\": \"application/json\",\r\n                    },\r\n                });\r\n\r\n                const data = await response.json();\r\n\r\n                if (data.success) {\r\n                    showNotification(\"Успішно видалено\");\r\n\r\n                    // Видаляємо HTML-рядок\r\n                    const row = form.closest(\"tr\");\r\n                    if (row) row.remove();\r\n                } else {\r\n                    showNotification(\"Помилка видалення\", \"error\");\r\n                }\r\n            } catch (err) {\r\n                console.error(\"Delete error:\", err);\r\n                showNotification(`Помилка запиту ${err}`, \"error\");\r\n            }\r\n        });\r\n    });\r\n});\r\n"],"file":"crm.js"}