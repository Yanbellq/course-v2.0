{"version":3,"names":[],"mappings":"","sources":["newsletter.js"],"sourcesContent":["import showNotification from './toast.js';\r\n\r\n// ============ NEWSLETTER SUBSCRIPTION ============\r\nconst newsletterForm = document.getElementById('newsletterForm');\r\n\r\nif (newsletterForm) {\r\n    newsletterForm.addEventListener('submit', async (e) => {\r\n        e.preventDefault();\r\n        \r\n        const emailInput = newsletterForm.querySelector('input[type=\"email\"]');\r\n        const submitButton = newsletterForm.querySelector('button[type=\"submit\"]');\r\n        const email = emailInput.value.trim();\r\n\r\n        if (!email) {\r\n            showNotification('Please enter your email address', 'error');\r\n            return;\r\n        }\r\n\r\n        // Валідація email на клієнті\r\n        const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\r\n        if (!emailPattern.test(email)) {\r\n            showNotification('Please enter a valid email address', 'error');\r\n            return;\r\n        }\r\n\r\n        // Блокуємо кнопку під час відправки\r\n        const originalButtonText = submitButton.textContent;\r\n        submitButton.disabled = true;\r\n        submitButton.textContent = 'Subscribing...';\r\n\r\n        try {\r\n            console.log('Sending newsletter subscription request for:', email);\r\n            const response = await fetch('/api/newsletter/subscribe/', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({ email }),\r\n            });\r\n\r\n            console.log('Newsletter subscription response status:', response.status);\r\n\r\n            let data;\r\n            try {\r\n                data = await response.json();\r\n            } catch (jsonError) {\r\n                console.error('Failed to parse JSON response:', jsonError);\r\n                const text = await response.text();\r\n                console.error('Response text:', text);\r\n                showNotification('Server error. Please try again later.', 'error');\r\n                return;\r\n            }\r\n\r\n            console.log('Newsletter subscription response data:', data);\r\n\r\n            if (data.success) {\r\n                showNotification(data.message || 'Thank you for subscribing!', 'success');\r\n                newsletterForm.reset();\r\n            } else {\r\n                showNotification(data.message || 'An error occurred. Please try again.', 'error');\r\n            }\r\n        } catch (error) {\r\n            console.error('Newsletter subscription error:', error);\r\n            showNotification('Network error. Please check your connection and try again.', 'error');\r\n        } finally {\r\n            // Розблоковуємо кнопку\r\n            submitButton.disabled = false;\r\n            submitButton.textContent = originalButtonText;\r\n        }\r\n    });\r\n}\r\n\r\n"],"file":"newsletter.js"}