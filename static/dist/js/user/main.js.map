{"version":3,"names":[],"mappings":"","sources":["main.js"],"sourcesContent":["import showNotification from './toast.js';\nimport debounce from '../utility/debounce.js';\n\n// ============ MOBILE MENU ============\nconst mobileToggle = document.getElementById('mobileToggle');\nconst navMenu = document.getElementById('navMenu');\n\nif (mobileToggle) {\n    mobileToggle.addEventListener('click', () => {\n        navMenu.classList.toggle('active');\n        mobileToggle.classList.toggle('active');\n    });\n}\n\n// Close mobile menu when clicking outside\ndocument.addEventListener('click', (e) => {\n    if (!e.target.closest('.navbar') && navMenu) {\n        navMenu.classList.remove('active');\n        if (mobileToggle) mobileToggle.classList.remove('active');\n    }\n});\n\n// ============ SEARCH OVERLAY ============\nconst searchToggle = document.getElementById('searchToggle');\nconst searchOverlay = document.getElementById('searchOverlay');\nconst searchClose = document.getElementById('searchClose');\nconst searchInput = document.getElementById('searchInput');\n\nif (searchToggle) {\n    searchToggle.addEventListener('click', () => {\n        searchOverlay.classList.toggle('active');\n        searchInput.focus();\n    });\n}\n\nif (searchClose) {\n    const resultsContainer = document.getElementById('searchResults');\n\n    searchClose.addEventListener('click', () => {\n        // searchOverlay.classList.remove('active');\n        searchInput.value = '';\n        if (resultsContainer) resultsContainer.innerHTML = '';\n    });\n}\n\ndocument.addEventListener('click', (e) => {\n    if (\n        searchOverlay &&\n        !e.target.closest('.navbar') &&\n        !e.target.closest('#searchOverlay')\n    ) {\n        searchOverlay.classList.remove('active');\n        if (searchInput) searchInput.value = '';\n    }\n});\n\nconst resultsContainer = document.getElementById(\"searchResults\");\n\nasync function performSearch(query) {\n    if (query.length < 3) {\n        resultsContainer.innerHTML = \"\";\n        return;\n    }\n\n    const response = await fetch(`/api/search/?q=${encodeURIComponent(query)}`);\n    const data = await response.json();\n\n    if (!data.results.length) {\n        resultsContainer.innerHTML = `<p style=\"padding: 20px; text-align: center; color: #666; font-size: 15px;\">No results found</p>`;\n        return;\n    }\n\n    resultsContainer.innerHTML = data.results.map(p => `\n        <a href=\"/product/${p.id}\" class=\"search-result-item\">\n            <div class=\"search-result-image-container\">\n                <img src=\"${p.image_url}\" alt=\"${p.name}\" class=\"search-result-image\">\n            </div>\n            <div class=\"search-result-info\">\n                <h4>${p.name}</h4>\n                <p>$${p.price}</p>\n            </div>\n        </a>\n    `).join('');\n}\n\nsearchInput.addEventListener(\"input\", debounce(e => {\n    performSearch(e.target.value);\n}, 250));\n\n// ============ ACCORDION ============\nconst accordionHeaders = document.querySelectorAll('.accordion-header');\n\naccordionHeaders.forEach(header => {\n    header.addEventListener('click', () => {\n        const item = header.parentElement;\n        const wasActive = item.classList.contains('active');\n\n        // Close all accordion items\n        document.querySelectorAll('.accordion-item').forEach(i => {\n            i.classList.remove('active');\n        });\n\n        // Open clicked item if it wasn't active\n        if (!wasActive) {\n            item.classList.add('active');\n        }\n    });\n});\n\n// ============ NEWSLETTER ============\nconst newsletterForm = document.getElementById('newsletterForm');\n\nif (newsletterForm) {\n    newsletterForm.addEventListener('submit', (e) => {\n        e.preventDefault();\n        const email = newsletterForm.querySelector('input').value;\n\n        if (email) {\n            alert(`Thank you for subscribing with: ${email}`);\n            newsletterForm.reset();\n        }\n    });\n}\n\n// ============ SMOOTH SCROLL ============\ndocument.querySelectorAll('a[href^=\"#\"]').forEach(anchor => {\n    anchor.addEventListener('click', function (e) {\n        const href = this.getAttribute('href');\n        if (href !== '#' && href.length > 1) {\n            e.preventDefault();\n            const target = document.querySelector(href);\n            if (target) {\n                target.scrollIntoView({\n                    behavior: 'smooth',\n                    block: 'start'\n                });\n                if (navMenu) navMenu.classList.remove('active');\n                if (mobileToggle) mobileToggle.classList.remove('active');\n            }\n        }\n    });\n});\n\n// ============ SCROLL ANIMATIONS ============\nconst observerOptions = {\n    threshold: 0.1,\n    rootMargin: '0px 0px -50px 0px'\n};\n\nconst observer = new IntersectionObserver((entries) => {\n    entries.forEach(entry => {\n        if (entry.isIntersecting) {\n            entry.target.style.opacity = '1';\n            entry.target.style.transform = 'translateY(0)';\n        }\n    });\n}, observerOptions);\n\ndocument.querySelectorAll('section').forEach(section => {\n    section.style.opacity = '0';\n    section.style.transform = 'translateY(30px)';\n    section.style.transition = 'all 0.6s ease-out';\n    observer.observe(section);\n});\n\nconst scrollToTopBtn = document.getElementById(\"scrollToTopBtn\");\nconst logoScrollToTopBtn = document.getElementById(\"logoScrollToTop\");\n\n\n// ============ Scroll to top button functionality ============\nfunction scrollToTop() {\n    window.scrollTo({\n        top: 0,\n        behavior: \"smooth\"\n    });\n    if (navMenu) navMenu.classList.remove('active');\n    if (mobileToggle) mobileToggle.classList.remove('active');\n}\n\nif (scrollToTopBtn) {\n    scrollToTopBtn.addEventListener(\"click\", scrollToTop);\n}\n\nif (logoScrollToTopBtn) {\n    logoScrollToTopBtn.addEventListener(\"click\", scrollToTop);\n}\n\n\n// ============ CHECK IF USER IS LOGGED IN ============\nfunction checkAuth() {\n    const user = localStorage.getItem('user') || sessionStorage.getItem('user');\n    const admin = localStorage.getItem('admin') || sessionStorage.getItem('admin');\n\n    if (user || admin) {\n        const userData = JSON.parse(user || admin);\n        console.log('Logged in as:', userData);\n\n        // Update UI if on main page\n        const userBtn = document.getElementById('userBtn');\n        if (userBtn && userData.username) {\n            userBtn.innerHTML = `\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                    <circle cx=\"10\" cy=\"7\" r=\"4\"/>\n                    <path d=\"M3 19C3 15 6 13 10 13C14 13 17 15 17 19\"/>\n                </svg>\n            `;\n            userBtn.title = `Logged in as ${userData.username || userData.email}`;\n        }\n    }\n}\n\n// Check auth on page load\ncheckAuth();\n\n// ============ LOGOUT FUNCTIONALITY ============\nasync function logout() {\n\n    const user = localStorage.getItem('user') || sessionStorage.getItem('user');\n    const userData = JSON.parse(user);\n    \n    const resp = await fetch('/api/user/auth/logout/', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${userData.tokens.access}`\n        }\n    });\n\n    localStorage.removeItem('user');\n    sessionStorage.removeItem('user');\n\n    showNotification('Logged out successfully', 'success');\n\n    setTimeout(() => {\n        if (window.location.pathname === '/') {\n            window.location.reload();\n        } else {\n            window.location.href = '/';\n        }\n    }, 100);\n}\n\n// Add logout button functionality (you can add this to the header)\ndocument.addEventListener('DOMContentLoaded', () => {\n    const user = localStorage.getItem('user') || sessionStorage.getItem('user');\n    const userBtn = document.getElementById('userBtn');\n\n    if (user) {\n        // Create a logout button in the header\n\n        const navIcons = document.getElementById('navIcons');\n\n        const header = document.querySelector('header') || document.body;\n        let logoutBtn = document.getElementById('logoutBtn');\n\n        if (!logoutBtn) {\n            logoutBtn = document.createElement('button');\n            logoutBtn.id = 'logoutBtn';\n            logoutBtn.innerHTML = `\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n                    <path d=\"M7 2H3C2.44772 2 2 2.44772 2 3V17C2 17.5523 2.44772 18 3 18H7\"\n                        stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" />\n                    <path d=\"M13 14L18 10M18 10L13 6M18 10H7\" stroke=\"currentColor\" stroke-width=\"2\"\n                        stroke-linecap=\"round\" stroke-linejoin=\"round\" />\n                </svg>\n            `;\n            logoutBtn.classList.add('icon-btn', 'logout-btn');\n            logoutBtn.addEventListener('click', logout);\n            navIcons.appendChild(logoutBtn);\n        }\n\n        console.log('User is logged in. Add logout button to UI.');\n    }\n\n    if (user) {\n        userBtn.href = '/profile/';\n    }\n});"],"file":"main.js"}