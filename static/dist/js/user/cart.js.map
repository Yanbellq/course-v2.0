{"version":3,"names":[],"mappings":"","sources":["cart.js"],"sourcesContent":["// ============ CART FUNCTIONALITY ============\nimport showNotification from \"./toast.js\";\n\nclass ShoppingCart {\n    constructor() {\n        this.items = this.loadCart();\n        this.cartSidebar = document.getElementById('cartSidebar');\n        this.cartToggle = document.getElementById('cartToggle');\n        this.cartClose = document.getElementById('cartClose');\n        this.continueShopping = document.getElementById('continueShopping');\n        this.overlay = document.getElementById('overlay');\n        this.cartCount = document.getElementById('cartCount');\n        this.cartItems = document.getElementById('cartItems');\n        this.cartSubtotal = document.getElementById('cartSubtotal');\n        this.cartTotal = document.getElementById('cartTotal');\n\n        this.init();\n    }\n\n    init() {\n        // Load cart from localStorage\n        this.updateUI();\n\n        // Event listeners\n        if (this.cartToggle) {\n            this.cartToggle.addEventListener('click', () => this.openCart());\n        }\n\n        if (this.cartClose) {\n            this.cartClose.addEventListener('click', () => this.closeCart());\n        }\n\n        if (this.continueShopping) {\n            this.continueShopping.addEventListener('click', () => this.closeCart());\n        }\n\n        if (this.overlay) {\n            this.overlay.addEventListener('click', () => this.closeCart());\n        }\n\n        // Add to cart buttons\n        this.setupAddToCartButtons();\n    }\n\n    setupAddToCartButtons() {\n        document.addEventListener('click', (e) => {\n            if (e.target.classList.contains('btn--add-cart')) {\n                const btn = e.target;\n\n                // ✅ Безпечний пошук інпуту з кількістю\n                const container = btn.closest('.product-actions');\n                let quantity = 1; // значення за замовчуванням\n\n                if (container) {\n                    const qtyInput = container.querySelector('#quantity');\n                    if (qtyInput && qtyInput.value) {\n                        quantity = parseInt(qtyInput.value) || 1;\n                    }\n                }\n\n                const product = {\n                    id: btn.dataset.id,\n                    name: btn.dataset.name,\n                    price: parseFloat(btn.dataset.price),\n                    image: btn.dataset.image,\n                    quantity: quantity\n                };\n\n                this.addItem(product);\n                showNotification('Product added to cart!');\n            }\n        });\n    }\n\n\n\n    addItem(product) {\n        const existingItem = this.items.find(item => item.id === product.id);\n\n        if (existingItem) {\n            existingItem.quantity += product.quantity; // ✅ тепер коректно додає кількість\n        } else {\n            this.items.push(product);\n        }\n\n        this.saveCart();\n        this.updateUI();\n    }\n\n\n    removeItem(productId) {\n        this.items = this.items.filter(item => item.id !== productId);\n        this.saveCart();\n        this.updateUI();\n    }\n\n    updateQuantity(productId, newQuantity) {\n        const item = this.items.find(item => item.id === productId);\n\n        if (item) {\n            if (newQuantity <= 0) {\n                this.removeItem(productId);\n            } else {\n                item.quantity = newQuantity;\n                this.saveCart();\n                this.updateUI();\n            }\n        }\n    }\n\n    getTotal() {\n        return this.items.reduce((total, item) => {\n            return total + (item.price * item.quantity);\n        }, 0);\n    }\n\n    updateUI() {\n        // Update cart count\n        const totalItems = this.items.reduce((sum, item) => sum + item.quantity, 0);\n        if (this.cartCount) {\n            this.cartCount.textContent = totalItems;\n            this.cartCount.style.display = totalItems > 0 ? 'flex' : 'none';\n        }\n\n        // Update cart items\n        if (this.cartItems) {\n            if (this.items.length === 0) {\n                this.cartItems.innerHTML = `\n                    <div class=\"cart-empty\">\n                        <svg width=\"80\" height=\"80\" viewBox=\"0 0 80 80\" fill=\"none\">\n                            <circle cx=\"40\" cy=\"40\" r=\"38\" stroke=\"#e0e0e0\" stroke-width=\"4\"/>\n                            <path d=\"M30 50L50 30M50 50L30 30\" stroke=\"#e0e0e0\" stroke-width=\"4\" stroke-linecap=\"round\"/>\n                        </svg>\n                        <p style='font-size: 15px;'>Your cart is empty</p>\n                    </div>\n                `;\n            } else {\n                this.cartItems.innerHTML = this.items.map(item => `\n                    <div class=\"cart-item\" data-id=\"${item.id}\">\n                        <div class=\"cart-item-image\">\n                            <img src=\"${item.image}\" alt=\"${item.name}\">\n                        </div>\n                        <div class=\"cart-item-info\">\n                            <h4>${item.name}</h4>\n                            <div class=\"cart-item-price\">$${item.price.toFixed(2)}</div>\n                            <div class=\"cart-item-quantity\">\n                                <button class=\"qty-btn qty-minus\" data-id=\"${item.id}\">-</button>\n                                <span class=\"qty-value\">${item.quantity}</span>\n                                <button class=\"qty-btn qty-plus\" data-id=\"${item.id}\">+</button>\n                            </div>\n                        </div>\n                        <button class=\"cart-item-remove\" data-id=\"${item.id}\">×</button>\n                    </div>\n                `).join('');\n\n                // Add event listeners for quantity buttons\n                this.setupCartItemButtons();\n            }\n        }\n\n        // Update totals\n        const total = this.getTotal();\n        if (this.cartSubtotal) {\n            this.cartSubtotal.textContent = `$${total.toFixed(2)}`;\n        }\n        if (this.cartTotal) {\n            this.cartTotal.textContent = `$${total.toFixed(2)}`;\n        }\n    }\n\n    setupCartItemButtons() {\n        // Remove buttons\n        document.querySelectorAll('.cart-item-remove').forEach(btn => {\n            btn.addEventListener('click', () => {\n                const id = btn.dataset.id;\n                this.removeItem(id);\n                showNotification('Product removed from cart');\n            });\n        });\n\n        // Quantity buttons\n        document.querySelectorAll('.qty-minus').forEach(btn => {\n            btn.addEventListener('click', () => {\n                const id = btn.dataset.id;\n                const item = this.items.find(item => item.id === id);\n                if (item) {\n                    this.updateQuantity(id, item.quantity - 1);\n                }\n            });\n        });\n\n        document.querySelectorAll('.qty-plus').forEach(btn => {\n            btn.addEventListener('click', () => {\n                const id = btn.dataset.id;\n                const item = this.items.find(item => item.id === id);\n                if (item) {\n                    this.updateQuantity(id, item.quantity + 1);\n                }\n            });\n        });\n    }\n\n    openCart() {\n        if (this.cartSidebar) {\n            this.cartSidebar.classList.add('active');\n        }\n        if (this.overlay) {\n            this.overlay.classList.add('active');\n        }\n        document.body.style.overflow = 'hidden';\n    }\n\n    closeCart() {\n        if (this.cartSidebar) {\n            this.cartSidebar.classList.remove('active');\n        }\n        if (this.overlay) {\n            this.overlay.classList.remove('active');\n        }\n        document.body.style.overflow = '';\n    }\n\n    saveCart() {\n        localStorage.setItem('cart', JSON.stringify(this.items));\n    }\n\n    loadCart() {\n        const saved = localStorage.getItem('cart');\n        return saved ? JSON.parse(saved) : [];\n    }\n\n    clearCart() {\n        this.items = [];\n        this.saveCart();\n        this.updateUI();\n    }\n}\n\n// Initialize cart\nconst cart = new ShoppingCart();\n\n// Checkout button\ndocument.addEventListener('click', (e) => {\n    if (e.target.classList.contains('btn--checkout')) {\n        if (cart.items.length > 0) {\n            alert('Proceeding to checkout...\\nTotal: $' + cart.getTotal().toFixed(2));\n            // Here you would redirect to checkout page\n            // window.location.href = 'checkout.html';\n        } else {\n            alert('Your cart is empty!');\n        }\n    }\n});\n"],"file":"cart.js"}