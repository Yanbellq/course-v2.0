{"version":3,"names":[],"mappings":"","sources":["pages/customers.js"],"sourcesContent":["// static/src/js/pages/customers.js\n\nimport Button from '../components/button.js';\n\n\nconst customerTable = document.querySelector('#customer-list-table');\nif (customerTable) {\n    console.log('Initializing customer list page...');\n    loadCustomers();\n}\n\nconst pageHeaderActions = document.querySelector('#page-header-actions');\nif (pageHeaderActions) {\n    pageHeaderActions.insertAdjacentHTML('beforeend', \n        Button('Додати клієнта', \"add\", 'shadow-glow', 'plus', '')\n    );\n    // if (window.lucide?.createIcons) window.lucide.createIcons();\n}\n\n\n\nasync function loadCustomers() {\n    const tableBody = document.querySelector('#customer-list-body');\n    if (!tableBody) return;\n\n    // Показуємо стан завантаження\n    tableBody.innerHTML = `\n        <tr>\n            <td colspan=\"5\" class=\"text-center\">\n                <div class=\"loading-spinner\" style=\"display: inline-block; vertical-align: middle;\">\n                    <div class=\"spinner\" style=\"width: 24px; height: 24px; border-width: 3px;\"></div>\n                </div>\n                <span style=\"vertical-align: middle; margin-left: 10px;\">Завантаження клієнтів...</span>\n            </td>\n        </tr>\n    `;\n\n    try {\n        // Робимо запит до нашого API\n        const response = await PCManagement.apiRequest('/customers/');\n        renderCustomers(response.customers, tableBody);\n    } catch (error) {\n        console.error('Failed to load customers:', error);\n        tableBody.innerHTML = `\n            <tr>\n                <td colspan=\"5\" class=\"text-center text-error\">\n                    Не вдалося завантажити список клієнтів. Спробуйте оновити сторінку.\n                </td>\n            </tr>\n        `;\n    }\n}\n\nfunction renderCustomers(customers, tableBody) {\n    if (!customers || customers.length === 0) {\n        tableBody.innerHTML = `\n            <tr>\n                <td colspan=\"5\" class=\"text-center\">Клієнтів не знайдено. <a href=\"/customers/add/\">Додайте першого</a>.</td>\n            </tr>\n        `;\n        return;\n    }\n\n    const rowsHtml = customers.map(customer => {\n        // Форматуємо дату за допомогою глобальної функції з main.js\n        const registrationDate = PCManagement.formatDate(customer.created_at);\n\n        return `\n            <tr data-customer-id=\"${customer.id}\">\n                <td><a href=\"/customers/${customer.id}/\" class=\"font-semibold underline\">${customer.name} ${customer.surname}</a></td>\n                <td>${customer.email}</td>\n                <td>${customer.phone}</td>\n                <td>${registrationDate}</td>\n                <td>\n                    <a href=\"/customers/${customer.id}/edit/\" class=\"btn btn--sm btn--secondary\">Редагувати</a>\n                    <button class=\"btn btn--sm btn--error\" data-action=\"delete\" data-url=\"/customers/${customer.id}/\" data-confirm=\"Ви впевнені, що хочете видалити клієнта ${customer.name} ${customer.surname}?\">Видалити</button>\n                </td>\n            </tr>\n        `;\n    }).join('');\n\n    tableBody.innerHTML = rowsHtml;\n}"],"file":"pages/customers.js"}