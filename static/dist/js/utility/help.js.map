{"version":3,"names":[],"mappings":"","sources":["help.js"],"sourcesContent":["/**\r\n * –°–∏—Å—Ç–µ–º–∞ –¥–æ–ø–æ–º–æ–≥–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞\r\n * –í—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –Ω–∞ –∫–ª–∞–≤—ñ—à—É F1\r\n */\r\n\r\nclass HelpSystem {\r\n    constructor() {\r\n        this.modal = null;\r\n        this.overlay = null;\r\n        this.isOpen = false;\r\n        this.userRole = this.getUserRole();\r\n        \r\n        this.init();\r\n    }\r\n\r\n    getUserRole() {\r\n        // –°–ø—Ä–æ–±—É—î–º–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ä–æ–ª—å –∑ —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª\r\n        // 1. –ó data-–∞—Ç—Ä–∏–±—É—Ç–∞ –Ω–∞ body (—è–∫—â–æ –ø–µ—Ä–µ–¥–∞–Ω–æ –∑ —Å–µ—Ä–≤–µ—Ä–∞)\r\n        const bodyRole = document.body.getAttribute('data-user-role');\r\n        if (bodyRole && bodyRole !== 'guest') return bodyRole;\r\n\r\n        // 2. –ó localStorage/sessionStorage –¥–ª—è CRM (admin)\r\n        try {\r\n            const admin = localStorage.getItem('admin') || sessionStorage.getItem('admin');\r\n            if (admin) {\r\n                const adminData = JSON.parse(admin);\r\n                return adminData.role || 'admin';\r\n            }\r\n        } catch (e) {\r\n            console.warn('Could not parse admin from storage:', e);\r\n        }\r\n\r\n        // 3. –ó localStorage/sessionStorage (–¥–ª—è API –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó)\r\n        try {\r\n            const user = localStorage.getItem('user') || sessionStorage.getItem('user');\r\n            if (user) {\r\n                const userData = JSON.parse(user);\r\n                return userData.role || 'user';\r\n            }\r\n        } catch (e) {\r\n            console.warn('Could not parse user from storage:', e);\r\n        }\r\n\r\n        // 4. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ data-–∞—Ç—Ä–∏–±—É—Ç (–Ω–∞–≤—ñ—Ç—å —è–∫—â–æ guest)\r\n        if (bodyRole) return bodyRole;\r\n\r\n        // 5. –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º - guest\r\n        return 'guest';\r\n    }\r\n\r\n    init() {\r\n        // –°—Ç–≤–æ—Ä—é—î–º–æ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ\r\n        this.createModal();\r\n        \r\n        // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ –∫–ª–∞–≤—ñ—à—ñ F1\r\n        document.addEventListener('keydown', (e) => {\r\n            if (e.key === 'F1') {\r\n                e.preventDefault();\r\n                this.open();\r\n            }\r\n        });\r\n\r\n        // –ó–∞–∫—Ä–∏–≤–∞—î–º–æ –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ Escape\r\n        document.addEventListener('keydown', (e) => {\r\n            if (e.key === 'Escape' && this.isOpen) {\r\n                this.close();\r\n            }\r\n        });\r\n    }\r\n\r\n    createModal() {\r\n        // –°—Ç–≤–æ—Ä—é—î–º–æ overlay\r\n        this.overlay = document.createElement('div');\r\n        this.overlay.className = 'help-overlay';\r\n        this.overlay.addEventListener('click', () => this.close());\r\n\r\n        // –°—Ç–≤–æ—Ä—é—î–º–æ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ\r\n        this.modal = document.createElement('div');\r\n        this.modal.className = 'help-modal';\r\n        this.modal.innerHTML = this.getModalContent();\r\n\r\n        // –î–æ–¥–∞—î–º–æ –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä–∏—Ç—Ç—è\r\n        const closeBtn = this.modal.querySelector('.help-close');\r\n        if (closeBtn) {\r\n            closeBtn.addEventListener('click', () => this.close());\r\n        }\r\n\r\n        // –î–æ–¥–∞—î–º–æ –≤ DOM\r\n        document.body.appendChild(this.overlay);\r\n        document.body.appendChild(this.modal);\r\n    }\r\n\r\n    getModalContent() {\r\n        const role = this.userRole;\r\n        const content = this.getHelpContent(role);\r\n\r\n        return `\r\n            <div class=\"help-modal-header\">\r\n                <h2 class=\"help-title\">User Guide</h2>\r\n                <button class=\"help-close\" aria-label=\"Close\">\r\n                    <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\r\n                        <path d=\"M18 6L6 18M6 6L18 18\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\"/>\r\n                    </svg>\r\n                </button>\r\n            </div>\r\n            <div class=\"help-modal-body\">\r\n                <div class=\"help-role-badge\">\r\n                    <span class=\"help-role-label\">Your role:</span>\r\n                    <span class=\"help-role-value help-role-${role}\">${this.getRoleName(role)}</span>\r\n                </div>\r\n                ${content}\r\n            </div>\r\n            <div class=\"help-modal-footer\">\r\n                <p class=\"help-hint\">Press <kbd>F1</kbd> to open this guide, <kbd>ESC</kbd> to close</p>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    getRoleName(role) {\r\n        const names = {\r\n            'guest': 'Guest',\r\n            'user': 'User',\r\n            'operator': 'Operator',\r\n            'admin': 'Admin'\r\n        };\r\n        return names[role] || role;\r\n    }\r\n\r\n    getHelpContent(role) {\r\n        const contents = {\r\n            'guest': this.getGuestContent(),\r\n            'user': this.getUserContent(),\r\n            'operator': this.getOperatorContent(),\r\n            'admin': this.getAdminContent()\r\n        };\r\n        return contents[role] || contents['guest'];\r\n    }\r\n\r\n    getGuestContent() {\r\n        return `\r\n            <div class=\"help-section\">\r\n                <h3 class=\"help-section-title\">What you can do:</h3>\r\n                <ul class=\"help-list\">\r\n                    <li>‚úÖ View the catalog of products and their details</li>\r\n                    <li>‚úÖ View the categories of products</li>\r\n                    <li>‚úÖ Use the product search</li>\r\n                    <li>‚úÖ View the information about the company</li>\r\n                </ul>\r\n            </div>\r\n            <div class=\"help-section\">\r\n                <h3 class=\"help-section-title\">How to get more access:</h3>\r\n                <div class=\"help-upgrade\">\r\n                    <p>To get full access to the system you need to:</p>\r\n                    <ol class=\"help-steps\">\r\n                        <li>Register in the system or login if you already have an account</li>\r\n                        <li>After registration you will get the role <strong>User</strong>, which will allow you to:</li>\r\n                        <ul>\r\n                            <li>Save the search results</li>\r\n                            <li>Execute built-in queries to the database</li>\r\n                            <li>Get access to additional functions</li>\r\n                        </ul>\r\n                    </ol>\r\n                    <div class=\"help-action\">\r\n                        <a href=\"/auth/\" class=\"btn btn--primary\">Register / Login</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    getUserContent() {\r\n        return `\r\n            <div class=\"help-section\">\r\n                <h3 class=\"help-section-title\">What you can do:</h3>\r\n                <ul class=\"help-list\">\r\n                    <li>‚úÖ View the catalog of products and their details</li>\r\n                    <li>‚úÖ Use the product search</li>\r\n                    <li>‚úÖ View and search data in the system</li>\r\n                    <li>‚úÖ Execute built-in SQL queries and aggregations</li>\r\n                    <li>‚úÖ Save the results of built-in SQL queries</li>\r\n                    <li>‚úÖ View your profile</li>\r\n                </ul>\r\n            </div>\r\n            <div class=\"help-section\">\r\n                <h3 class=\"help-section-title\">Restrictions:</h3>\r\n                <ul class=\"help-list help-list-restricted\">\r\n                    <li>‚ùå You cannot form new SQL queries</li>\r\n                    <li>‚ùå You cannot edit or delete data</li>\r\n                    <li>‚ùå You cannot add new records</li>\r\n                </ul>\r\n            </div>\r\n            <div class=\"help-section\">\r\n                <h3 class=\"help-section-title\">How to get more access:</h3>\r\n                <div class=\"help-upgrade\">\r\n                    <p>To get the rights <strong>Operator</strong> or <strong>Admin</strong> contact the administrator of the system.</p>\r\n                    <p><strong>Operator</strong> can:</p>\r\n                    <ul>\r\n                        <li>Add, edit and delete data</li>\r\n                        <li>Form new SQL queries and aggregations</li>\r\n                        <li>Execute all operations with data</li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    getOperatorContent() {\r\n        return `\r\n            <div class=\"help-section\">\r\n                <h3 class=\"help-section-title\">What you can do:</h3>\r\n                <ul class=\"help-list\">\r\n                    <li>‚úÖ Add new records to the system</li>\r\n                    <li>‚úÖ View all data</li>\r\n                    <li>‚úÖ Edit existing records</li>\r\n                    <li>‚úÖ Delete records</li>\r\n                    <li>‚úÖ Execute built-in SQL queries and aggregations</li>\r\n                    <li>‚úÖ Form new SQL queries and aggregations</li>\r\n                    <li>‚úÖ Manage suppliers, contracts, deliveries</li>\r\n                    <li>‚úÖ Manage sales, repairs, deliveries</li>\r\n                    <li>‚úÖ Manage products and categories</li>\r\n                </ul>\r\n            </div>\r\n            <div class=\"help-section\">\r\n                <h3 class=\"help-section-title\">Restrictions:</h3>\r\n                <ul class=\"help-list help-list-restricted\">\r\n                    <li>‚ùå You cannot add operators</li>\r\n                    <li>‚ùå You cannot register users</li>\r\n                    <li>‚ùå You cannot change user roles</li>\r\n                </ul>\r\n            </div>\r\n            <div class=\"help-section\">\r\n                <h3 class=\"help-section-title\">How to get more access:</h3>\r\n                <div class=\"help-upgrade\">\r\n                    <p>To get the rights <strong>Admin</strong> contact the administrator of the system.</p>\r\n                    <p><strong>Admin</strong> has all the rights of the operator, plus:</p>\r\n                    <ul>\r\n                        <li>Adding operators</li>\r\n                        <li>Registering users after requests</li>\r\n                        <li>Rejecting registration requests</li>\r\n                        <li>Full control of users and their roles</li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    getAdminContent() {\r\n        return `\r\n            <div class=\"help-section\">\r\n                <h3 class=\"help-section-title\">What you can do:</h3>\r\n                <ul class=\"help-list\">\r\n                    <li>‚úÖ <strong>All operator rights</strong></li>\r\n                    <li>‚úÖ Adding operators</li>\r\n                    <li>‚úÖ Registering users after requests</li>\r\n                    <li>‚úÖ Rejecting registration requests</li>\r\n                    <li>‚úÖ Forming new SQL queries and aggregations</li>\r\n                    <li>‚úÖ Managing all users and their roles</li>\r\n                    <li>‚úÖ Full access to all system functions</li>\r\n                    <li>‚úÖ Access to analytics and reports</li>\r\n                    <li>‚úÖ Full control of all system entities</li>\r\n                </ul>\r\n            </div>\r\n            <div class=\"help-section\">\r\n                <h3 class=\"help-section-title\">Managing the system:</h3>\r\n                <ul class=\"help-list\">\r\n                    <li>üìä You have access to the CRM panel for managing data</li>\r\n                    <li>üë• You can manage users in the \"Users\" section</li>\r\n                    <li>üìà You have access to analytics and reports</li>\r\n                    <li>‚öôÔ∏è You can configure the system and access rights</li>\r\n                </ul>\r\n            </div>\r\n            <div class=\"help-section\">\r\n                <h3 class=\"help-section-title\">Note:</h3>\r\n                <p>You have the highest level of access to the system. Be careful when performing operations, especially when deleting data or changing user roles.</p>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    open() {\r\n        if (this.isOpen) return;\r\n        \r\n        // –û–Ω–æ–≤–ª—é—î–º–æ —Ä–æ–ª—å (–Ω–∞ –≤–∏–ø–∞–¥–æ–∫ –∑–º—ñ–Ω–∏)\r\n        this.userRole = this.getUserRole();\r\n        this.modal.innerHTML = this.getModalContent();\r\n        \r\n        // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ –∑–∞–∫—Ä–∏—Ç—Ç—è\r\n        const closeBtn = this.modal.querySelector('.help-close');\r\n        if (closeBtn) {\r\n            closeBtn.addEventListener('click', () => this.close());\r\n        }\r\n\r\n        // –ü–æ–∫–∞–∑—É—î–º–æ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ\r\n        this.overlay.classList.add('active');\r\n        this.modal.classList.add('active');\r\n        this.isOpen = true;\r\n        \r\n        // –ë–ª–æ–∫—É—î–º–æ –ø—Ä–æ–∫—Ä—É—Ç–∫—É body\r\n        document.body.style.overflow = 'hidden';\r\n    }\r\n\r\n    close() {\r\n        if (!this.isOpen) return;\r\n        \r\n        this.overlay.classList.remove('active');\r\n        this.modal.classList.remove('active');\r\n        this.isOpen = false;\r\n        \r\n        // –í—ñ–¥–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–æ–∫—Ä—É—Ç–∫—É body\r\n        document.body.style.overflow = '';\r\n    }\r\n}\r\n\r\n// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ —Å–∏—Å—Ç–µ–º—É –¥–æ–ø–æ–º–æ–≥–∏\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    window.helpSystem = new HelpSystem();\r\n});\r\n\r\nexport default HelpSystem;\r\n\r\n"],"file":"help.js"}