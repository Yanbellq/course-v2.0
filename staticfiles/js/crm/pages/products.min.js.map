{"version":3,"file":"products.min.js","sources":["pages/products.js"],"sourcesContent":["// 'use strict'\n\n// static/src/js/pages/products.js\n\nimport Button from '../components/button.js';\n// import Button from '../../../../dist_ts/components/btn.js';\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const productTable = document.querySelector('#product-list-table');\n    if (productTable) {\n        console.log('Initializing product list page...');\n        loadProducts();\n    }\n});\n\nconst pageHeaderActions = document.querySelector('#page-header-actions');\nif (pageHeaderActions) {\n    pageHeaderActions.insertAdjacentHTML('beforeend',\n        Button('Додати товар', \"add\", 'shadow-glow', 'plus', '')\n    );\n    // if (window.lucide?.createIcons) window.lucide.createIcons();\n}\n\n\nasync function loadProducts() {\n    const tableBody = document.querySelector('#product-list-body');\n    const table = document.querySelector('#product-list-table');\n    if (!tableBody) return;\n\n    tableBody.innerHTML = `\n        <tr>\n            <td colspan=\"6\" class=\"text-center\">\n                <div class=\"loading-spinner\" style=\"display: inline-block; vertical-align: middle;\">\n                    <div class=\"spinner\" style=\"width: 24px; height: 24px; border-width: 3px;\"></div>\n                </div>\n                <span style=\"vertical-align: middle; margin-left: 10px;\">Завантаження товарів...</span>\n            </td>\n        </tr>\n    `;\n\n    try {\n        const response = await PCManagement.apiRequest('/products/');\n        renderProducts(response.products, tableBody);\n        // Після рендерингу даних, ініціалізуємо функціонал таблиці\n        PCManagement.initDataTable('#product-list-table', { pageSize: 15 });\n    } catch (error) {\n        console.error('Failed to load products:', error);\n        tableBody.innerHTML = `\n            <tr>\n                <td colspan=\"6\" class=\"text-center text-error\">\n                    Не вдалося завантажити список товарів.\n                </td>\n            </tr>\n        `;\n    }\n}\n\n\nfunction renderProducts(products, tableBody) {\n    if (!products || products.length === 0) {\n        tableBody.innerHTML = `\n            <tr>\n                <td colspan=\"6\" class=\"text-center\">\n                    <div>\n                        <div class=\"flex items-center justify-center pt-4\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" data-lucide=\"package\" class=\"lucide lucide-package h-10 w-10 text-gray-600\">\n                                <path d=\"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z\"></path>\n                                <path d=\"M12 22V12\"></path>\n                                <polyline points=\"3.29 7 12 12 20.71 7\"></polyline>\n                                <path d=\"m7.5 4.27 9 5.15\"></path>\n                            </svg>\n                        </div>\n                        <h3 class=\"mt-2 text-base font-medium text-gray-900 text-center mt-4\">Товари не знайдено</h3>\n                        <p class=\"mt-1 text-sm text-gray-500 text-center pb-4 mt-2\">\n                            Спробуйте змінити параметри пошуку або створіть новий товар.\n                        </p>\n                    </div>\n                </td>\n            </tr>\n        `;\n        return;\n    }\n\n    const rowsHtml = products.map(product => {\n        const price = PCManagement.formatCurrency(product.price);\n        const stockClass = product.quantity_in_stock <= product.min_stock_level ? 'text-error' : '';\n\n        return `\n            <tr data-product-id=\"${product.id}\">\n                <td><a href=\"/products/${product.id}/\" class=\"font-semibold underline\">${product.name}</a></td>\n                <td>${product.category}</td>\n                <td>${product.manufacturer || '—'}</td>\n                <td>${price}</td>\n                <td class=\"${stockClass}\">${product.quantity_in_stock}</td>\n                <td class=\"dropdown-data\">\n                    <button type=\"button\" class=\"dropdown-toggle\">...</button>\n                    <ul class=\"dropdown-menu\">\n                        <li>\n                            <a href=\"/products/${product.id}/edit/\" class=\"btn btn--sm btn--secondary\">\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" data-lucide=\"square-pen\" class=\"lucide lucide-square-pen h-4 w-4\">\n                                    <path d=\"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\n                                    <path d=\"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z\"></path>\n                                </svg>\n                                Редагувати\n                            </a>\n                        </li>\n                        <li>\n                            <button class=\"btn btn--sm btn--error w-full\" data-action=\"delete\" data-url=\"/products/${product.id}/\" data-confirm=\"Ви впевнені, що хочете видалити товар ${product.name}?\">\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" data-lucide=\"trash-2\" class=\"lucide lucide-trash-2 h-4 w-4\">\n                                    <path d=\"M10 11v6\"></path><path d=\"M14 11v6\"></path>\n                                    <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6\"></path>\n                                    <path d=\"M3 6h18\"></path><path d=\"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"></path>\n                                </svg>\n                                Видалити\n                            </button>\n                        </li>\n                    </ul>\n                </td>\n            </tr>\n        `;\n    }).join('');\n\n    tableBody.innerHTML = rowsHtml;\n\n\n    function initDropdowns() {\n        document.querySelectorAll('.dropdown-data').forEach(dropdown => {\n            const dropdownToggle = dropdown.querySelector('.dropdown-toggle');\n            const dropdownMenu = dropdown.querySelector('.dropdown-menu');\n\n            dropdownToggle.addEventListener('click', (e) => {\n                // Close all dropdowns first\n                document.querySelectorAll('.dropdown-menu.active').forEach(menu => {\n                    if (menu !== dropdownMenu) {\n                        menu.classList.remove('active');\n                    }\n                });\n                // Toggle only the clicked dropdown\n                dropdownMenu.classList.toggle('active');\n            });\n        });\n\n        // Optional: close dropdowns when clicking outside\n        document.addEventListener('click', (e) => {\n            if (!e.target.closest('.dropdown-data')) {\n                document.querySelectorAll('.dropdown-menu.active').forEach(menu => {\n                    menu.classList.remove('active');\n                });\n            }\n        });\n    }\n\n    initDropdowns();\n}\n\n\n// <a href=\"/products/${product.id}/edit/\" class=\"btn btn--sm btn--secondary\">Редагувати</a>\n// <button class=\"btn btn--sm btn--error\" data-action=\"delete\" data-url=\"/products/${product.id}/\" data-confirm=\"Ви впевнені, що хочете видалити товар ${product.name}?\">Видалити</button>"],"names":["Button","document","addEventListener","querySelector","console","log","loadProducts","pageHeaderActions","async","tableBody","innerHTML","renderProducts","await","PCManagement","apiRequest","products","initDataTable","pageSize","error","length","rowsHtml","map","product","price","formatCurrency","stockClass","quantity_in_stock","min_stock_level","id","name","category","manufacturer","join","querySelectorAll","forEach","dropdown","dropdownToggle","dropdownMenu","menu","classList","remove","toggle","e","target","closest","insertAdjacentHTML"],"mappings":"OAIOA,WAAY,0BAGnBC,SAASC,iBAAiB,mBAAoB,WACrBD,SAASE,cAAc,qBAAqB,IAE7DC,QAAQC,IAAI,mCAAmC,EAC/CC,aAAa,EAErB,CAAC,EAED,IAAMC,kBAAoBN,SAASE,cAAc,sBAAsB,EASvEK,eAAeF,eACX,IAAMG,EAAYR,SAASE,cAAc,oBAAoB,EAC/CF,SAASE,cAAc,qBAAqB,EAC1D,GAAKM,EAAL,CAEAA,EAAUC;;;;;;;;;MAWV,IAEIC,gBADiBC,MAAMC,aAAaC,WAAW,YAAY,GACnCC,SAAUN,CAAS,EAE3CI,aAAaG,cAAc,sBAAuB,CAAEC,SAAU,EAAG,CAAC,CAUtE,CATE,MAAOC,GACLd,QAAQc,MAAM,2BAA4BA,CAAK,EAC/CT,EAAUC;;;;;;SAOd,CA3BsB,CA4B1B,CAGA,SAASC,eAAeI,EAAUN,GACzBM,GAAgC,IAApBA,EAASI,QAwBpBC,EAAWL,EAASM,IAAIC,IAC1B,IAAMC,EAAQV,aAAaW,eAAeF,EAAQC,KAAK,EACjDE,EAAaH,EAAQI,mBAAqBJ,EAAQK,gBAAkB,aAAe,GAEzF;mCAC2BL,EAAQM;yCACFN,EAAQM,wCAAwCN,EAAQO;sBAC3EP,EAAQQ;sBACRR,EAAQS,cAAgB;sBACxBR;6BACOE,MAAeH,EAAQI;;;;;iDAKHJ,EAAQM;;;;;;;;;qHAS4DN,EAAQM,4DAA4DN,EAAQO;;;;;;;;;;;;SAa7L,CAAC,EAAEG,KAAK,EAAE,EAEVvB,EAAUC,UAAYU,EAIlBnB,SAASgC,iBAAiB,gBAAgB,EAAEC,QAAQC,IAChD,IAAMC,EAAiBD,EAAShC,cAAc,kBAAkB,EAChE,IAAMkC,EAAeF,EAAShC,cAAc,gBAAgB,EAE5DiC,EAAelC,iBAAiB,QAAS,IAErCD,SAASgC,iBAAiB,uBAAuB,EAAEC,QAAQI,IACnDA,IAASD,GACTC,EAAKC,UAAUC,OAAO,QAAQ,CAEtC,CAAC,EAEDH,EAAaE,UAAUE,OAAO,QAAQ,CAC1C,CAAC,CACL,CAAC,EAGDxC,SAASC,iBAAiB,QAAS,IAC1BwC,EAAEC,OAAOC,QAAQ,gBAAgB,GAClC3C,SAASgC,iBAAiB,uBAAuB,EAAEC,QAAQI,IACvDA,EAAKC,UAAUC,OAAO,QAAQ,CAClC,CAAC,CAET,CAAC,GAzFD/B,EAAUC;;;;;;;;;;;;;;;;;;;SA6FlB,CAzIIH,mBACAA,kBAAkBsC,mBAAmB,YACjC7C,OAAO,eAAgB,MAAO,cAAe,OAAQ,EAAE,CAC3D"}